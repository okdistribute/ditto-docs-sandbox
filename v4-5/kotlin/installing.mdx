---
title : "Installing Kotlin SDK"
---

You can integrate the Ditto SDK into Kotlin projects to develop native apps for the Android platform.&#x20;

<Info>
For a complete overview of the platforms, transports, and devices the Kotlin SDK supports, see [Compatibility with Kotlin](<./Compatibility with Kotlin.md>).
</Info>

To install the Kotlin SDK and start syncing offline:

<Steps>
<Step>
Confirm that you meet the minimum requirements. ([Prerequisites]())
</Step>

<Step>
Prepare your environment for Ditto. ([Setting Up Your Environment]())
</Step>

<Step>
Configure your app permissions. ([Setting Up Permissions]())
</Step>

<Step>
Authenticate with the Big Peer and then start syncing offline. ([Integrating and Initializing]())
</Step>
</Steps>

# Prerequisites

Following are the minimum requirements that must be met before attempting to install Ditto.

- Android version 6.0 (Marshmallow)
- `minSdk` version 23.0
- `compileSdk` version 31.0
- Java Development Kit (JDK) version 11.0

# Setting Up Your Environment

# Setting Up Permissions

## Android Manifest Permissions

The Ditto Android SDK includes a set of permissions that are required to use all
the device features necessary to enable sync. The permissions below will be
automatically merged into your app's final manifest.

<Tabs>
<Tab title="AndroidManifest.xml">
```xml
<manifest
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:android="http://schemas.android.com/apk/res/android">

<uses-permission android:name="android.permission.BLUETOOTH"
    android:maxSdkVersion="30" />
<uses-permission android:name="android.permission.BLUETOOTH_ADMIN"
    android:maxSdkVersion="30" />
<uses-permission android:name="android.permission.BLUETOOTH_ADVERTISE"
    tools:targetApi="s" />
<uses-permission android:name="android.permission.BLUETOOTH_CONNECT"
    tools:targetApi="s" />
<uses-permission android:name="android.permission.BLUETOOTH_SCAN"
    android:usesPermissionFlags="neverForLocation"
    tools:targetApi="s" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"
    android:maxSdkVersion="32" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"
    android:maxSdkVersion="30" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE" />
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
<uses-permission android:name="android.permission.NEARBY_WIFI_DEVICES"
    android:usesPermissionFlags="neverForLocation"
    tools:targetApi="tiramisu" />

```
</Tab>
</Tabs>

The `tools:targetApi` attribute causes the permission to only be requested on
devices running the specified API level or higher. This avoids errors in older
OS versions that do not recognize the permission.

The `android:maxSdkVersion` attribute causes permission to only be requested
on devices running the specified SDK level or lower. This avoids asking for more
permissions than Ditto needs; however, it will prevent your app from being able
to request permission on devices running a newer OS version.&#x20;

To opt out of this behavior and request permission on all OS versions, see the following
snippet:

<Tabs>
<Tab title="Location Permission Override">
```xml
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"
    tools:remove="android:maxSdkVersion" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"
    tools:remove="android:maxSdkVersion" />
```

</Tab>
</Tabs>

Note that you may need to add the `xmlns:tools="http://schemas.android.com/tools"`
namespace attribute to your app's root `<manifest>` tag as shown in the
`AndroidManifest.xml` example above.

This will configure your app's build to ignore the `android:maxSdkVersion`
attribute in our SDK allowing the permission to be requested on any SDK version.
This technique can be used to tweak any permissions to your liking.

For more details, see the documentation for the [Bluetooth ](https://developer.android.com/guide/topics/connectivity/bluetooth/permissions)and [WiFi Aware ](https://developer.android.com/guide/topics/connectivity/wifi-permissions)permissions in the Android Documentation.

## Runtime Permissions

The `DittoSyncPermissions` object requires a Context. You can get the context by invoking `getApplicationContext()`, `getContext()`, `getBaseContext()` or this when in a class that extends from Context, such as the Application, Activity, Service, and IntentService Classes.

```kotlin
fun checkPermissions() {
    val missing = DittoSyncPermissions(this).missingPermissions()
    if (missing.isNotEmpty()) {
        this.requestPermissions(missing, 0)
    }
}
```

Alternatively, `requireActivity()` is a way to force the code to only work on a Fragment that has a Context.

```kotlin
fun checkPermissions() {
    val activity = requireActivity()
    val missing = DittoSyncPermissions(activity).missingPermissions()
    if (missing.isNotEmpty()) {
        activity.requestPermissions(missing, 0)
    }
}
```

```kotlin
override fun onRequestPermissionsResult(
    requestCode: Int,
    permissions: Array<out String>,
    grantResults: IntArray
) {
    super.onRequestPermissionsResult(requestCode, permissions, grantResults)
    // Regardless of the outcome, tell Ditto that permissions maybe changed
    ditto?.refreshPermissions()
}
```

# Integrating and Initializing

<Steps>
<Step>
Add Ditto to your application.

We recommend placing this in your Application.onCreate method. Note that the `Context` you want to reference here is the `Application level` `Context`, rather than whatever Activity you might happen to be instantiating the Ditto instance from initially.&#x20;

This is because you need to ensure that your app is keeping a single Ditto instance alive for the entire lifetime of the application so it is not going out of scope or getting garbage collected.

```kotlin
try {
    val androidDependencies = DefaultAndroidDittoDependencies(context)
    val identity = DittoIdentity.OnlinePlayground(
        androidDependencies,
        appId = "REPLACE_ME_WITH_YOUR_APP_ID",
        token = "REPLACE_ME_WITH_YOUR_PLAYGROUND_TOKEN"
    )
    DittoLogger.minimumLogLevel = DittoLogLevel.DEBUG
    ditto = Ditto(androidDependencies, identity)
    ditto.startSync()
} catch (e: DittoError) {
    Log.e("Ditto error", e.message!!)
}
```

</Step>

<Step>
Replace `YOUR_APP_ID` and `YOUR_PLAYGROUND_TOKEN` with your access credentials available from the portal.&#x20;

<Info>
For instructions on how to obtain your access credentials, see [Onboarding](/v4-4/onboarding). For an introduction to authentication in Ditto, see *Ditto Basics* > [Authentication and Initialization](</v4-5/basics/authentication-and-initialization>).
</Info>
</Step>
</Steps>
